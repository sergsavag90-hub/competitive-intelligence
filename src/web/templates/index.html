<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Competitive Intelligence Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-align: center;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 25px;
            cursor: pointer;
            background: transparent;
            border: none;
            font-size: 1.1em;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            color: #764ba2;
            border-bottom-color: #764ba2;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .scan-card {
            background: #f7f9fc;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .scan-card h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .form-row {
            display: flex;
            flex-direction: column;
            margin-bottom: 15px;
        }

        .form-row label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #444;
        }

        .form-row input,
        .form-row select,
        .form-row textarea {
            padding: 12px 15px;
            border: 1px solid #d5d8de;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.2s ease;
            font-family: inherit;
        }

        .form-row textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-row input:focus,
        .form-row select:focus,
        .form-row textarea:focus {
            border-color: #764ba2;
            outline: none;
        }

        .primary-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: opacity 0.2s ease;
        }

        .primary-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .primary-btn:hover:not(:disabled) {
            opacity: 0.9;
        }

        .secondary-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: opacity 0.2s ease;
        }

        .secondary-btn:hover {
            opacity: 0.8;
        }

        .scan-status {
            margin-top: 15px;
            min-height: 40px;
            font-family: monospace;
            background: #eef2ff;
            border-radius: 10px;
            padding: 10px;
            color: #333;
            word-break: break-word;
        }

        .scan-status pre {
            white-space: pre-wrap;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .stat-card h3 {
            font-size: 1em;
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .stat-card .value {
            font-size: 2.5em;
            font-weight: bold;
        }
        
        .competitors-list {
            margin-top: 30px;
        }
        
        .competitor-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 5px solid #667eea;
            transition: transform 0.2s;
        }
        
        .competitor-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .competitor-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .competitor-url {
            color: #667eea;
            text-decoration: none;
            font-size: 0.9em;
        }
        
        .competitor-stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .badge {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .badge.success {
            background: #28a745;
        }

        .badge.warning {
            background: #ffc107;
            color: #333;
        }

        .badge.danger {
            background: #dc3545;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #666;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        tr:hover {
            background: #f5f7fa;
        }

        tr:last-child td {
            border-bottom: none;
        }

        .pagination-help {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .pagination-help h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .pagination-help p {
            color: #856404;
            line-height: 1.6;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover,
        .close:focus {
            color: #000;
        }

        .semantic-core {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .semantic-core h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .keyword-cluster {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .keyword-cluster h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .keyword-tag {
            background: #e0e7ff;
            color: #4c51bf;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9em;
            font-weight: 600;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .alert-warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
        }

        .alert-danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .vnc-viewer-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .vnc-viewer-card h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üïµÔ∏è Competitive Intelligence Dashboard</h1>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('overview')">üìä –û–≥–ª—è–¥</button>
            <button class="tab" onclick="switchTab('scan')">üîç –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è</button>
            <button class="tab" onclick="switchTab('tests')">üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è</button>
            <button class="tab" onclick="switchTab('seo')">üìà SEO –ê–Ω–∞–ª—ñ–∑</button>
            <button class="tab" onclick="switchTab('vnc')">üñ•Ô∏è –ë—Ä–∞—É–∑–µ—Ä–∏ (VNC)</button>
            <button class="tab" onclick="switchTab('settings')">‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</button>
        </div>

        <!-- Overview Tab -->
        <div id="tab-overview" class="tab-content active">
            <div class="stats-grid" id="statsGrid">
                <div class="stat-card">
                    <h3>–í—Å—å–æ–≥–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤</h3>
                    <div class="value" id="totalCompetitors">-</div>
                </div>
                <div class="stat-card">
                    <h3>–¢–æ–≤–∞—Ä—ñ–≤ –≤—ñ–¥—Å—Ç–µ–∂—É—î—Ç—å—Å—è</h3>
                    <div class="value" id="totalProducts">-</div>
                </div>
                <div class="stat-card">
                    <h3>–ê–∫—Ç–∏–≤–Ω–∏—Ö –∞–∫—Ü—ñ–π</h3>
                    <div class="value" id="totalPromotions">-</div>
                </div>
                <div class="stat-card">
                    <h3>–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è</h3>
                    <div class="value" id="lastUpdate" style="font-size: 1.2em;">-</div>
                </div>
            </div>
            
            <div class="competitors-list">
                <h2>–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–∏</h2>
                <div id="competitorsList" class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
            </div>
        </div>

        <!-- Scan Tab -->
        <div id="tab-scan" class="tab-content">
            <div class="scan-card">
                <h2>–®–≤–∏–¥–∫–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Å–∞–π—Ç—É</h2>
                <form id="scanForm">
                    <div class="form-row">
                        <label for="scanUrl">URL —Å–∞–π—Ç—É</label>
                        <input type="url" id="scanUrl" placeholder="https://example.com" required>
                    </div>
                    <div class="form-row">
                        <label for="scanType">–¢–∏–ø –∞–Ω–∞–ª—ñ–∑—É</label>
                        <select id="scanType">
                            <option value="full">–ü–æ–≤–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ (SEO + –ö–æ–Ω—Ç–∞–∫—Ç–∏ + –¢–æ–≤–∞—Ä–∏ + –ê–∫—Ü—ñ—ó)</option>
                            <option value="seo">–¢—ñ–ª—å–∫–∏ SEO</option>
                            <option value="company">–¢—ñ–ª—å–∫–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ñ –¥–∞–Ω—ñ</option>
                            <option value="products">–¢—ñ–ª—å–∫–∏ —Ç–æ–≤–∞—Ä–∏</option>
                            <option value="promotions">–¢—ñ–ª—å–∫–∏ –∞–∫—Ü—ñ—ó</option>
                        </select>
                    </div>
                    <button type="submit" class="primary-btn" id="scanSubmit">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è</button>
                </form>
                <div id="scanStatus" class="scan-status"></div>
                <div id="scanProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%">0%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tests Tab -->
        <div id="tab-tests" class="tab-content">
            <div class="scan-card">
                <h2>üß™ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è</h2>
                <p style="margin-bottom: 20px; color: #666;">
                    –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ñ–æ—Ä–º —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó, –∫–æ–Ω—Ç–∞–∫—Ç–Ω–∏—Ö —Ñ–æ—Ä–º —Ç–∞ —ñ–Ω—à–∏—Ö —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –Ω–∞ —Å–∞–π—Ç–∞—Ö –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤.
                </p>
                <form id="testForm">
                    <div class="form-row">
                        <label for="testUrl">URL —Å–∞–π—Ç—É –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è</label>
                        <input type="url" id="testUrl" placeholder="https://example.com" required>
                    </div>
                    <button type="submit" class="primary-btn" id="testSubmit">üß™ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è</button>
                </form>
                <div id="testStatus" class="scan-status"></div>
            </div>

            <div class="scan-card">
                <h2>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è</h2>
                <div id="testResults">
                    <div class="loading">–ù–µ–º–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è</div>
                </div>
            </div>
        </div>

        <!-- SEO Analysis Tab -->
        <div id="tab-seo" class="tab-content">
            <div class="scan-card">
                <h2>üìà –ü–æ–≤–Ω–∏–π SEO –∞–Ω–∞–ª—ñ–∑ —Å–∞–π—Ç—É</h2>
                <p style="margin-bottom: 20px; color: #666;">
                    –ê–Ω–∞–ª—ñ–∑ –≤—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —Å–∞–π—Ç—É –∑ –ø–æ–±—É–¥–æ–≤–æ—é —Å–µ–º–∞–Ω—Ç–∏—á–Ω–æ–≥–æ —è–¥—Ä–∞ —Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤.
                </p>
                <form id="seoForm">
                    <div class="form-row">
                        <label for="seoUrl">URL —Å–∞–π—Ç—É</label>
                        <input type="url" id="seoUrl" placeholder="https://example.com" required>
                    </div>
                    <div class="form-row">
                        <label for="maxPages">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É</label>
                        <input type="number" id="maxPages" value="50" min="1" max="500">
                    </div>
                    <div class="form-row">
                        <label for="maxDepth">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –≥–ª–∏–±–∏–Ω–∞ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è</label>
                        <input type="number" id="maxDepth" value="3" min="1" max="10">
                    </div>
                    <button type="submit" class="primary-btn" id="seoSubmit">üìä –ó–∞–ø—É—Å—Ç–∏—Ç–∏ SEO –∞–Ω–∞–ª—ñ–∑</button>
                </form>
                <div id="seoStatus" class="scan-status"></div>
                <div id="seoProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="seoProgressFill" style="width: 0%">0%</div>
                    </div>
                </div>
            </div>

            <div id="paginationHelp" class="pagination-help" style="display: none;">
                <h3>‚ö†Ô∏è –ü–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞ –∑ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—î—é</h3>
                <p id="paginationMessage"></p>
                <div class="form-row" style="margin-top: 15px;">
                    <label for="paginationPattern">–®–∞–±–ª–æ–Ω –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)</label>
                    <input type="text" id="paginationPattern" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: /page/2/, /page/3/, –∞–±–æ ?page=2, ?page=3">
                    <small style="color: #666; margin-top: 5px; display: block;">
                        –í–≤–µ–¥—ñ—Ç—å –ø—Ä–∏–∫–ª–∞–¥–∏ URL —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó, —Ä–æ–∑–¥—ñ–ª–µ–Ω—ñ –∫–æ–º–∞–º–∏
                    </small>
                </div>
                <button class="primary-btn" onclick="submitPaginationHelp()">–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –∑ —Ü–∏–º —à–∞–±–ª–æ–Ω–æ–º</button>
                <button class="secondary-btn" onclick="skipPagination()">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—é</button>
            </div>

            <div id="semanticCore" class="semantic-core" style="display: none;">
                <h3>üéØ –°–µ–º–∞–Ω—Ç–∏—á–Ω–µ —è–¥—Ä–æ</h3>
                <div id="semanticCoreContent"></div>
            </div>
        </div>

        <!-- VNC Tab -->
        <div id="tab-vnc" class="tab-content">
            <div class="scan-card">
                <h2>üñ•Ô∏è –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –±—Ä–∞—É–∑–µ—Ä—ñ–≤ (VNC)</h2>
                <p style="margin-bottom: 20px; color: #666;">
                    –ü–µ—Ä–µ–≥–ª—è–¥ –±—Ä–∞—É–∑–µ—Ä—ñ–≤ Selenium Grid —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ —á–µ—Ä–µ–∑ VNC.
                </p>
                
                <div class="alert alert-info" style="margin-bottom: 20px;">
                    <strong>‚ÑπÔ∏è –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è:</strong> –î–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –±—Ä–∞—É–∑–µ—Ä—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± VNC –ø–æ—Ä—Ç–∏ –±—É–ª–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –Ω–∞ —Ö–æ—Å—Ç—ñ Selenium Grid.
                    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ—Ä—Ç–∏: Chrome Node 1 - 7901, Chrome Node 2 - 7902, Firefox - 7903, Edge - 7904.
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 20px;">
                    <div class="vnc-viewer-card">
                        <h3>Chrome Node 1</h3>
                        <iframe 
                            src="http://localhost:7901/?autoconnect=true&resize=scale" 
                            style="width: 100%; height: 400px; border: 1px solid #ddd; border-radius: 8px;"
                            title="Chrome Node 1 VNC">
                        </iframe>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                            <a href="http://localhost:7901" target="_blank">üîó –í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ –Ω–æ–≤–æ–º—É –≤—ñ–∫–Ω—ñ</a>
                        </div>
                    </div>

                    <div class="vnc-viewer-card">
                        <h3>Chrome Node 2</h3>
                        <iframe 
                            src="http://localhost:7902/?autoconnect=true&resize=scale" 
                            style="width: 100%; height: 400px; border: 1px solid #ddd; border-radius: 8px;"
                            title="Chrome Node 2 VNC">
                        </iframe>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                            <a href="http://localhost:7902" target="_blank">üîó –í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ –Ω–æ–≤–æ–º—É –≤—ñ–∫–Ω—ñ</a>
                        </div>
                    </div>

                    <div class="vnc-viewer-card">
                        <h3>Firefox Node</h3>
                        <iframe 
                            src="http://localhost:7903/?autoconnect=true&resize=scale" 
                            style="width: 100%; height: 400px; border: 1px solid #ddd; border-radius: 8px;"
                            title="Firefox Node VNC">
                        </iframe>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                            <a href="http://localhost:7903" target="_blank">üîó –í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ –Ω–æ–≤–æ–º—É –≤—ñ–∫–Ω—ñ</a>
                        </div>
                    </div>

                    <div class="vnc-viewer-card">
                        <h3>Edge Node</h3>
                        <iframe 
                            src="http://localhost:7904/?autoconnect=true&resize=scale" 
                            style="width: 100%; height: 400px; border: 1px solid #ddd; border-radius: 8px;"
                            title="Edge Node VNC">
                        </iframe>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                            <a href="http://localhost:7904" target="_blank">üîó –í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ –Ω–æ–≤–æ–º—É –≤—ñ–∫–Ω—ñ</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="tab-settings" class="tab-content">
            <div class="scan-card">
                <h2>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h2>
                <form id="settingsForm">
                    <div class="form-row">
                        <label for="seleniumHub">Selenium Grid Hub URL</label>
                        <input type="url" id="seleniumHub" value="http://192.168.1.172:4444/wd/hub">
                    </div>
                    <div class="form-row">
                        <label for="browser">–ë—Ä–∞—É–∑–µ—Ä</label>
                        <select id="browser">
                            <option value="chrome" selected>Chrome</option>
                            <option value="firefox">Firefox</option>
                            <option value="edge">Edge</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>
                            <input type="checkbox" id="headless"> Headless —Ä–µ–∂–∏–º
                        </label>
                    </div>
                    <div class="form-row">
                        <label for="parallelWorkers">–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –≤–æ—Ä–∫–µ—Ä—ñ–≤</label>
                        <input type="number" id="parallelWorkers" value="3" min="1" max="10">
                    </div>
                    <div class="form-row">
                        <label for="retryAttempts">–°–ø—Ä–æ–± –ø–æ–≤—Ç–æ—Ä—É –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ</label>
                        <input type="number" id="retryAttempts" value="3" min="1" max="10">
                    </div>
                    <button type="submit" class="primary-btn">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</button>
                </form>
            </div>

            <div class="scan-card">
                <h2>üéØ –î–æ–¥–∞—Ç–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞</h2>
                <form id="addCompetitorForm">
                    <div class="form-row">
                        <label for="compName">–ù–∞–∑–≤–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞</label>
                        <input type="text" id="compName" placeholder="Competitor Inc." required>
                    </div>
                    <div class="form-row">
                        <label for="compUrl">URL —Å–∞–π—Ç—É</label>
                        <input type="url" id="compUrl" placeholder="https://competitor.com" required>
                    </div>
                    <div class="form-row">
                        <label for="compPriority">–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç (1-10)</label>
                        <input type="number" id="compPriority" value="5" min="1" max="10">
                    </div>
                    <button type="submit" class="primary-btn">‚ûï –î–æ–¥–∞—Ç–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Pagination Help Modal -->
    <div id="paginationModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closePaginationModal()">&times;</span>
            <h2>–î–æ–ø–æ–º–æ–∂—ñ—Ç—å –∑ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—î—é</h2>
            <p id="modalMessage"></p>
            <div class="form-row">
                <label for="modalPaginationPattern">–ü—Ä–∏–∫–ª–∞–¥–∏ URL –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó:</label>
                <textarea id="modalPaginationPattern" rows="4" placeholder="https://example.com/products?page=1&#10;https://example.com/products?page=2&#10;https://example.com/products?page=3"></textarea>
            </div>
            <button class="primary-btn" onclick="submitModalPagination()">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
            <button class="secondary-btn" onclick="closePaginationModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        </div>
    </div>
    
    <script>
        let currentScanJobId = null;
        let currentSeoJobId = null;

        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(`tab-${tabName}`).classList.add('active');
            
            // Add active class to selected tab
            event.target.classList.add('active');
        }

        async function loadData() {
            try {
                const response = await fetch('/api/competitors');
                const competitors = await response.json();
                
                let totalProducts = 0;
                let totalPromotions = 0;
                
                competitors.forEach(comp => {
                    totalProducts += comp.stats.total_products || 0;
                    totalPromotions += comp.stats.total_promotions || 0;
                });
                
                document.getElementById('totalCompetitors').textContent = competitors.length;
                document.getElementById('totalProducts').textContent = totalProducts;
                document.getElementById('totalPromotions').textContent = totalPromotions;
                document.getElementById('lastUpdate').textContent = new Date().toLocaleDateString('uk-UA');
                
                const listHtml = competitors.map(comp => `
                    <div class="competitor-card">
                        <div class="competitor-name">${comp.name}</div>
                        <a href="${comp.url}" target="_blank" class="competitor-url">${comp.url}</a>
                        <div class="competitor-stats">
                            <div class="stat-item">
                                <span class="badge">üõí ${comp.stats.total_products || 0} —Ç–æ–≤–∞—Ä—ñ–≤</span>
                            </div>
                            <div class="stat-item">
                                <span class="badge">üéÅ ${comp.stats.total_promotions || 0} –∞–∫—Ü—ñ–π</span>
                            </div>
                            <div class="stat-item">
                                <span class="badge ${comp.stats.has_seo_data ? 'success' : 'warning'}">
                                    ${comp.stats.has_seo_data ? '‚úì SEO' : '‚úó SEO'}
                                </span>
                            </div>
                            <div class="stat-item">
                                <span class="badge ${comp.enabled ? 'success' : 'danger'}">
                                    ${comp.enabled ? '‚úì –ê–∫—Ç–∏–≤–Ω–∏–π' : '‚úó –ù–µ–∞–∫—Ç–∏–≤–Ω–∏–π'}
                                </span>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                document.getElementById('competitorsList').innerHTML = listHtml || '<div class="loading">–î–∞–Ω–∏—Ö —â–µ –Ω–µ–º–∞—î</div>';
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('competitorsList').innerHTML = 
                    '<div class="loading">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö</div>';
            }
        }
        
        loadData();
        
        // Scan Form Handler
        const scanForm = document.getElementById('scanForm');
        if (scanForm) {
            scanForm.addEventListener('submit', handleScanSubmit);
        }

        async function handleScanSubmit(event) {
            event.preventDefault();
            const urlInput = document.getElementById('scanUrl');
            const typeSelect = document.getElementById('scanType');
            const submitBtn = document.getElementById('scanSubmit');

            displayScanStatus('–ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É –Ω–∞ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è...', 'info');
            submitBtn.disabled = true;
            showProgress('scanProgress', 10);

            try {
                const response = await fetch('/api/scan', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        url: urlInput.value.trim(),
                        scan_type: typeSelect.value
                    })
                });

                if (!response.ok) {
                    const err = await response.json().catch(() => ({}));
                    displayScanStatus(err.error || '–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è', 'error');
                    hideProgress('scanProgress');
                    submitBtn.disabled = false;
                    return;
                }

                const data = await response.json();
                currentScanJobId = data.job_id;
                displayScanStatus('–°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ. –û—á—ñ–∫—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç...', 'info');
                showProgress('scanProgress', 20);
                pollScan(data.job_id, submitBtn, 'scanProgress', 'progressFill');
            } catch (error) {
                console.error(error);
                displayScanStatus('–ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ –ø—ñ–¥ —á–∞—Å –∑–∞–ø—É—Å–∫—É —Å–∫–∞–Ω—É', 'error');
                hideProgress('scanProgress');
                submitBtn.disabled = false;
            }
        }

        function displayScanStatus(message, status = 'info', details = null) {
            const statusEl = document.getElementById('scanStatus');
            const colors = {
                info: '#333',
                success: '#0f8b63',
                error: '#c0392b'
            };
            let html = `<div style="color:${colors[status] || '#333'}; font-weight:600;">${message}</div>`;
            if (details) {
                html += `<pre>${JSON.stringify(details, null, 2)}</pre>`;
            }
            statusEl.innerHTML = html;
        }

        function showProgress(containerId, percent) {
            const container = document.getElementById(containerId);
            if (container) {
                container.style.display = 'block';
                const fillId = containerId === 'scanProgress' ? 'progressFill' : 'seoProgressFill';
                updateProgress(fillId, percent);
            }
        }

        function hideProgress(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                container.style.display = 'none';
            }
        }

        function updateProgress(fillId, percent) {
            const fill = document.getElementById(fillId);
            if (fill) {
                fill.style.width = percent + '%';
                fill.textContent = percent + '%';
            }
        }

        function pollScan(jobId, button, progressContainerId, progressFillId) {
            let progress = 20;
            async function checkStatus() {
                try {
                    const response = await fetch(`/api/scan/${jobId}`);
                    if (!response.ok) {
                        displayScanStatus('–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è', 'error');
                        hideProgress(progressContainerId);
                        button.disabled = false;
                        return;
                    }
                    const data = await response.json();
                    
                    // Update progress
                    if (progress < 90) {
                        progress += 10;
                        updateProgress(progressFillId, progress);
                    }

                    if (data.status === 'completed' || data.status === 'partial') {
                        updateProgress(progressFillId, 100);
                        displayScanStatus('‚úÖ –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ', 'success', data.result);
                        setTimeout(() => {
                            hideProgress(progressContainerId);
                            button.disabled = false;
                            loadData(); // Refresh data
                        }, 2000);
                        return;
                    }
                    if (data.status === 'failed') {
                        displayScanStatus(`‚ùå –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –ø–æ–º–∏–ª–∫–æ—é: ${data.error || '–Ω–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞'}`, 'error');
                        hideProgress(progressContainerId);
                        button.disabled = false;
                        return;
                    }
                    displayScanStatus(`‚è≥ –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ç—Ä–∏–≤–∞—î... –°—Ç–∞—Ç—É—Å: ${data.status}`, 'info');
                    setTimeout(checkStatus, 3000);
                } catch (error) {
                    console.error(error);
                    displayScanStatus('–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å—É', 'error');
                    hideProgress(progressContainerId);
                    button.disabled = false;
                }
            }
            checkStatus();
        }

        // Test Form Handler
        const testForm = document.getElementById('testForm');
        if (testForm) {
            testForm.addEventListener('submit', handleTestSubmit);
        }

        async function handleTestSubmit(event) {
            event.preventDefault();
            const urlInput = document.getElementById('testUrl');
            const submitBtn = document.getElementById('testSubmit');
            const statusEl = document.getElementById('testStatus');

            statusEl.innerHTML = '<div style="color:#333;">–ó–∞–ø—É—Å–∫ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è...</div>';
            submitBtn.disabled = true;

            try {
                const response = await fetch('/api/scan', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        url: urlInput.value.trim(),
                        scan_type: 'functional_test'
                    })
                });

                if (!response.ok) {
                    const err = await response.json().catch(() => ({}));
                    statusEl.innerHTML = `<div style="color:#c0392b;">${err.error || '–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è'}</div>`;
                    submitBtn.disabled = false;
                    return;
                }

                const data = await response.json();
                statusEl.innerHTML = '<div style="color:#333;">–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ. –û—á—ñ–∫—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤...</div>';
                pollTestResults(data.job_id, submitBtn, statusEl);
            } catch (error) {
                console.error(error);
                statusEl.innerHTML = '<div style="color:#c0392b;">–ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ</div>';
                submitBtn.disabled = false;
            }
        }

        function pollTestResults(jobId, button, statusEl) {
            async function checkStatus() {
                try {
                    const response = await fetch(`/api/scan/${jobId}`);
                    if (!response.ok) {
                        statusEl.innerHTML = '<div style="color:#c0392b;">–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å</div>';
                        button.disabled = false;
                        return;
                    }
                    const data = await response.json();
                    
                    if (data.status === 'completed' || data.status === 'partial') {
                        statusEl.innerHTML = '<div style="color:#0f8b63;">‚úÖ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>';
                        button.disabled = false;
                        displayTestResults(data.result);
                        return;
                    }
                    if (data.status === 'failed') {
                        statusEl.innerHTML = `<div style="color:#c0392b;">‚ùå –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–µ –≤–¥–∞–ª–æ—Å—è: ${data.error || 'unknown'}</div>`;
                        button.disabled = false;
                        return;
                    }
                    statusEl.innerHTML = `<div style="color:#333;">‚è≥ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è... –°—Ç–∞—Ç—É—Å: ${data.status}</div>`;
                    setTimeout(checkStatus, 3000);
                } catch (error) {
                    console.error(error);
                    statusEl.innerHTML = '<div style="color:#c0392b;">–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å—É</div>';
                    button.disabled = false;
                }
            }
            checkStatus();
        }

        function displayTestResults(result) {
            const resultsEl = document.getElementById('testResults');
            if (!result || !result.functional_test) {
                resultsEl.innerHTML = '<div class="loading">–ù–µ–º–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è</div>';
                return;
            }

            const testData = result.functional_test;
            let html = '<table><thead><tr><th>–¢–µ—Å—Ç</th><th>–°—Ç–∞—Ç—É—Å</th><th>–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</th></tr></thead><tbody>';
            
            if (testData.registration_test) {
                const status = testData.registration_test.status;
                const badge = status === 'success' ? 'success' : status === 'skipped' ? 'warning' : 'danger';
                html += `<tr>
                    <td>üìù –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</td>
                    <td><span class="badge ${badge}">${status}</span></td>
                    <td>${testData.registration_test.message || '-'}</td>
                </tr>`;
            }

            if (testData.contact_form_test) {
                const status = testData.contact_form_test.status;
                const badge = status === 'success' ? 'success' : status === 'skipped' ? 'warning' : 'danger';
                html += `<tr>
                    <td>üìß –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞ —Ñ–æ—Ä–º–∞</td>
                    <td><span class="badge ${badge}">${status}</span></td>
                    <td>${testData.contact_form_test.message || '-'}</td>
                </tr>`;
            }

            html += '</tbody></table>';
            resultsEl.innerHTML = html;
        }

        // SEO Form Handler
        const seoForm = document.getElementById('seoForm');
        if (seoForm) {
            seoForm.addEventListener('submit', handleSeoSubmit);
        }

        async function handleSeoSubmit(event) {
            event.preventDefault();
            const urlInput = document.getElementById('seoUrl');
            const maxPages = document.getElementById('maxPages').value;
            const maxDepth = document.getElementById('maxDepth').value;
            const submitBtn = document.getElementById('seoSubmit');
            const statusEl = document.getElementById('seoStatus');

            statusEl.innerHTML = '<div style="color:#333;">–ó–∞–ø—É—Å–∫ SEO –∞–Ω–∞–ª—ñ–∑—É...</div>';
            submitBtn.disabled = true;
            showProgress('seoProgress', 10);

            try {
                const response = await fetch('/api/seo/full-analysis', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        url: urlInput.value.trim(),
                        max_pages: parseInt(maxPages),
                        max_depth: parseInt(maxDepth)
                    })
                });

                if (!response.ok) {
                    const err = await response.json().catch(() => ({}));
                    statusEl.innerHTML = `<div style="color:#c0392b;">${err.error || '–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É –∞–Ω–∞–ª—ñ–∑—É'}</div>`;
                    hideProgress('seoProgress');
                    submitBtn.disabled = false;
                    return;
                }

                const data = await response.json();
                currentSeoJobId = data.job_id;
                statusEl.innerHTML = '<div style="color:#333;">SEO –∞–Ω–∞–ª—ñ–∑ –∑–∞–ø—É—â–µ–Ω–æ...</div>';
                showProgress('seoProgress', 20);
                pollSeoAnalysis(data.job_id, submitBtn, statusEl);
            } catch (error) {
                console.error(error);
                statusEl.innerHTML = '<div style="color:#c0392b;">–ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ</div>';
                hideProgress('seoProgress');
                submitBtn.disabled = false;
            }
        }

        function pollSeoAnalysis(jobId, button, statusEl) {
            let progress = 20;
            async function checkStatus() {
                try {
                    const response = await fetch(`/api/seo/analysis-status/${jobId}`);
                    if (!response.ok) {
                        statusEl.innerHTML = '<div style="color:#c0392b;">–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å</div>';
                        hideProgress('seoProgress');
                        button.disabled = false;
                        return;
                    }
                    const data = await response.json();
                    
                    // Update progress
                    if (data.progress) {
                        updateProgress('seoProgressFill', data.progress);
                    } else if (progress < 90) {
                        progress += 5;
                        updateProgress('seoProgressFill', progress);
                    }

                    if (data.status === 'completed') {
                        updateProgress('seoProgressFill', 100);
                        statusEl.innerHTML = '<div style="color:#0f8b63;">‚úÖ SEO –∞–Ω–∞–ª—ñ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>';
                        setTimeout(() => {
                            hideProgress('seoProgress');
                            button.disabled = false;
                            displaySemanticCore(data.result);
                        }, 2000);
                        return;
                    }
                    if (data.status === 'needs_help') {
                        showPaginationHelp(data.message);
                        statusEl.innerHTML = '<div style="color:#856404;">‚ö†Ô∏è –ü–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞ –∑ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—î—é</div>';
                        return;
                    }
                    if (data.status === 'failed') {
                        statusEl.innerHTML = `<div style="color:#c0392b;">‚ùå –ê–Ω–∞–ª—ñ–∑ –Ω–µ –≤–¥–∞–≤—Å—è: ${data.error || 'unknown'}</div>`;
                        hideProgress('seoProgress');
                        button.disabled = false;
                        return;
                    }
                    
                    const progressMsg = data.pages_analyzed ? ` (${data.pages_analyzed} —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–æ)` : '';
                    statusEl.innerHTML = `<div style="color:#333;">‚è≥ –ê–Ω–∞–ª—ñ–∑... –°—Ç–∞—Ç—É—Å: ${data.status}${progressMsg}</div>`;
                    setTimeout(checkStatus, 3000);
                } catch (error) {
                    console.error(error);
                    statusEl.innerHTML = '<div style="color:#c0392b;">–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å—É</div>';
                    hideProgress('seoProgress');
                    button.disabled = false;
                }
            }
            checkStatus();
        }

        function showPaginationHelp(message) {
            const helpDiv = document.getElementById('paginationHelp');
            const messageP = document.getElementById('paginationMessage');
            messageP.textContent = message;
            helpDiv.style.display = 'block';
        }

        async function submitPaginationHelp() {
            const pattern = document.getElementById('paginationPattern').value.trim();
            if (!currentSeoJobId) return;

            try {
                const response = await fetch('/api/seo/pagination-help', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        job_id: currentSeoJobId,
                        pagination_pattern: pattern
                    })
                });

                if (response.ok) {
                    document.getElementById('paginationHelp').style.display = 'none';
                    document.getElementById('seoStatus').innerHTML = '<div style="color:#333;">–ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ –∞–Ω–∞–ª—ñ–∑ –∑ –≤–∫–∞–∑–∞–Ω–∏–º —à–∞–±–ª–æ–Ω–æ–º...</div>';
                    // Continue polling
                    pollSeoAnalysis(currentSeoJobId, document.getElementById('seoSubmit'), document.getElementById('seoStatus'));
                }
            } catch (error) {
                console.error(error);
                alert('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –¥–æ–ø–æ–º–æ–≥–∏');
            }
        }

        function skipPagination() {
            submitPaginationHelp(); // Submit with empty pattern
        }

        function displaySemanticCore(result) {
            const coreDiv = document.getElementById('semanticCore');
            const contentDiv = document.getElementById('semanticCoreContent');
            
            if (!result || !result.semantic_core) {
                contentDiv.innerHTML = '<p>–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –ø—Ä–æ —Å–µ–º–∞–Ω—Ç–∏—á–Ω–µ —è–¥—Ä–æ</p>';
                coreDiv.style.display = 'block';
                return;
            }

            const core = result.semantic_core;
            let html = `<div class="alert alert-info">
                <strong>–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Å—Ç–æ—Ä—ñ–Ω–æ–∫:</strong> ${result.pages_analyzed || 0}<br>
                <strong>–£–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤:</strong> ${result.total_keywords || 0}
            </div>`;

            if (core.clusters && core.clusters.length > 0) {
                html += '<h4>–ö–ª–∞—Å—Ç–µ—Ä–∏ –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤:</h4>';
                core.clusters.forEach((cluster, index) => {
                    html += `<div class="keyword-cluster">
                        <h4>–ö–ª–∞—Å—Ç–µ—Ä ${index + 1}: ${cluster.name || 'Unnamed'}</h4>
                        <div class="keywords">
                            ${cluster.keywords.map(kw => `<span class="keyword-tag">${kw}</span>`).join('')}
                        </div>
                    </div>`;
                });
            }

            contentDiv.innerHTML = html;
            coreDiv.style.display = 'block';
        }

        function closePaginationModal() {
            document.getElementById('paginationModal').style.display = 'none';
        }

        function submitModalPagination() {
            const pattern = document.getElementById('modalPaginationPattern').value.trim();
            document.getElementById('paginationPattern').value = pattern;
            closePaginationModal();
            submitPaginationHelp();
        }

        // Settings Form Handler
        const settingsForm = document.getElementById('settingsForm');
        if (settingsForm) {
            settingsForm.addEventListener('submit', async (event) => {
                event.preventDefault();
                alert('–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ (—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª —É —Ä–æ–∑—Ä–æ–±—Ü—ñ)');
            });
        }

        // Add Competitor Form Handler
        const addCompForm = document.getElementById('addCompetitorForm');
        if (addCompForm) {
            addCompForm.addEventListener('submit', async (event) => {
                event.preventDefault();
                alert('–î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ (—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª —É —Ä–æ–∑—Ä–æ–±—Ü—ñ)');
            });
        }
    </script>
</body>
</html>
